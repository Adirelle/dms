{{- $url := .url -}}

{{- define "IconURI" -}}
    {{- with (index .Tags "upnp:albumArtURI") -}}
        {{- . -}}
    {{- else -}}
        {{- with (index .Tags "upnp:icon") -}}
            {{- . -}}
        {{- end -}}
    {{- end -}}
{{- end -}}

{{- define "Title" -}}
    <img class="icon" src="{{- template "IconURI" . -}}"/>{{.Title}}
{{- end -}}

<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic.min.css" />-->
    <title>{{ .model.Object.Title }} - DMS</title>
    <style>
        img.icon {
            max-width: 1em;
            max-height: 1em;
            vertical-align: baseline;
            margin: 0 0.5ex;
        }
    </style>
    {{- $base := .pathPrefix }}
</head>

<body>
    <div class="container">
        <nav class="navbar navbar-expand-lg">
            <ul class="navbar-nav mr-auto">
                <li>
                    <a class="navbar-brand" href="#">{{- template "Title" .model.Object -}}</a>
                </li>
            </ul>
            <a class="navbar-brand d-none d-md-inline" href="https://github.com/anacrolix/dms">DMS</a>
        </nav>
        <table class="table table-striped table-sm">
            <tbody>
                {{- with .model.Object.Tags }}
                <tr>
                    <th colspan="3">Tags</th>
                </tr>
                {{- range $name, $value := . }}
                <tr>
                    <td>{{ $name }}</td>
                    <td colspan="2">{{ $value }}</td>
                </tr>
                {{- end }} {{- end }} {{- with .model.Object.Resources }}
                <tr>
                    <th colspan="3">Resources</th>
                </tr>
                {{- range . }}
                <tr>
                    <td>
                        <a href="{{ .URI }}">{{ .URI }}</a>
                    </td>
                    <td><ul>
                        {{- range $name, $value := .Tags -}}
                            <li>{{ $name }}: {{ printf "%s" $value }}</li>
                        {{- end -}}
                    </ul></td>
                </tr>
                {{- end }} {{- end }} {{- with .model.Children }}
                <tr>
                    <th colspan="3">Children</th>
                </tr>
                {{- range . }}
                <tr>
                    <td>
                        <a href="{{ call $url "rest" "objectID" .ID }}">{{- template "Title" . -}}</a>
                    </td>
                </tr>
                {{- end }} {{- end }}
            </tbody>
        </table>
    </div>
</body>

</html>